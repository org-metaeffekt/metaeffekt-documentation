<!DOCTYPE html>
<html>
<head>
    <title>Cytoscape.js Graph with Swimlanes</title>
    <style>
        #cy {
            width: 100%;
            height: 100vh;
            display: block;
        }
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
    <!-- Include Cytoscape.js -->
    <script src="https://unpkg.com/cytoscape@3.19.1/dist/cytoscape.min.js"></script>
    <!-- Include cytoscape-node-html-label -->
    <script src="https://unpkg.com/cytoscape-node-html-label@1.2.0/dist/cytoscape-node-html-label.js"></script>
    <!-- Include dom-to-image -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>
    <!-- Include html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Include dagre for layout -->
    <script src="https://unpkg.com/dagre@0.8.5/dist/dagre.min.js"></script>
    <script src="https://unpkg.com/cytoscape-dagre@2.3.0/cytoscape-dagre.js"></script>
</head>
<body>

<div id="cy"></div>

<script>
    var elements = [{"data":{"id":"downloadersGroup","label":"Downloaders"},"classes":["graph-container"]},{"data":{"id":"indexesGroup","label":"Indexes"},"classes":["graph-container"]},{"data":{"id":"indexQueriesGroup","label":"Index Queries"},"classes":["graph-container"]},{"data":{"id":"enrichersGroup","label":"Enrichment Pipeline"},"classes":["graph-container"]},{"data":{"parent":"enrichersGroup","id":"phaseGroup_PRODUCT_IDENTIFICATION","label":"Product Identification"},"classes":["graph-container","enricher-phase"]},{"data":{"parent":"enrichersGroup","id":"phaseGroup_VULNERABILITY_MATCHING","label":"Vulnerability Matching"},"classes":["graph-container","enricher-phase"]},{"data":{"parent":"enrichersGroup","id":"phaseGroup_VULNERABILITY_DETAILS_FILLING","label":"Vulnerability Details Filling"},"classes":["graph-container","enricher-phase"]},{"data":{"parent":"enrichersGroup","id":"phaseGroup_ASSESSMENTS","label":"Assessments"},"classes":["graph-container","enricher-phase"]},{"data":{"parent":"enrichersGroup","id":"phaseGroup_SECURITY_ADVISORY_MATCHING","label":"Security Advisory Matching"},"classes":["graph-container","enricher-phase"]},{"data":{"parent":"enrichersGroup","id":"phaseGroup_VULNERABILITY_PRIORITIZATION","label":"Vulnerability Prioritization"},"classes":["graph-container","enricher-phase"]},{"data":{"parent":"enrichersGroup","id":"phaseGroup_INVENTORY_POST_PROCESSING","label":"Inventory Post Processing"},"classes":["graph-container","enricher-phase"]},{"data":{"parent":"enrichersGroup","id":"phaseGroup_REPORTING","label":"Reporting"},"classes":["graph-container","enricher-phase"]},{"data":{"parent":"downloadersGroup","id":"com.metaeffekt.mirror.download.nvd.NvdCveApiDownload","label":"<b>NVD CVE API</b><br>nvd / nvdCveDownload"},"classes":["graph-node","downloader"]},{"data":{"parent":"downloadersGroup","id":"com.metaeffekt.mirror.download.nvd.NvdCpeApiDownload","label":"<b>NVD CPE API</b><br>cpe-dict / nvdCpeDownload"},"classes":["graph-node","downloader"]},{"data":{"parent":"downloadersGroup","id":"com.metaeffekt.mirror.download.advisor.MsrcDownload","label":"<b>MSRC</b><br>msrc / msrcDownload"},"classes":["graph-node","downloader"]},{"data":{"parent":"downloadersGroup","id":"com.metaeffekt.mirror.download.advisor.MsrcSecurityGuideDownload","label":"<b>MSRC Security Guide</b><br>msrc-security-guide / msrcSecurityGuideDownload"},"classes":["graph-node","downloader"]},{"data":{"parent":"downloadersGroup","id":"com.metaeffekt.mirror.download.advisor.GhsaDownload","label":"<b>GHSA</b><br>github-advisory-database / githubAdvisorDownload"},"classes":["graph-node","downloader"]},{"data":{"parent":"downloadersGroup","id":"com.metaeffekt.mirror.download.advisor.CertSeiDownload","label":"<b>CERT-SEI</b><br>certsei / certSeiDownload"},"classes":["graph-node","downloader"]},{"data":{"parent":"downloadersGroup","id":"com.metaeffekt.mirror.download.advisor.CertFrDownload","label":"<b>CERT-FR</b><br>certfr / certFrDownload"},"classes":["graph-node","downloader"]},{"data":{"parent":"downloadersGroup","id":"com.metaeffekt.mirror.download.advisor.CertEuDownload","label":"<b>CERT-EU</b><br>certeu / certEuDownload"},"classes":["graph-node","downloader"]},{"data":{"parent":"downloadersGroup","id":"com.metaeffekt.mirror.download.other.CisaKevDownload","label":"<b>CISA KEV</b><br>kev / cisaKevDownload"},"classes":["graph-node","downloader"]},{"data":{"parent":"downloadersGroup","id":"com.metaeffekt.mirror.download.other.EpssDownload","label":"<b>EPSS</b><br>epss / epssDownload"},"classes":["graph-node","downloader"]},{"data":{"parent":"downloadersGroup","id":"com.metaeffekt.mirror.download.other.EolDownload","label":"<b>EOL</b><br>eol / eolDownload"},"classes":["graph-node","downloader"]},{"data":{"parent":"downloadersGroup","id":"com.metaeffekt.mirror.download.nvd.NvdDownload","label":"<b>NVD</b><br>nvd / nvdLegacyDownload"},"classes":["graph-node","downloader","deprecated"]},{"data":{"parent":"downloadersGroup","id":"com.metaeffekt.mirror.download.nvd.CpeDictionaryDownload","label":"<b>CPE Dictionary</b><br>cpe-dict / cpeDictionaryDownload"},"classes":["graph-node","downloader","deprecated"]},{"data":{"parent":"downloadersGroup","id":"com.metaeffekt.mirror.download.advisor.MsrcManualCsvDownload","label":"<b>MSRC Manual CSV</b><br>msrc-csv / msrcCsvDownload"},"classes":["graph-node","downloader","deprecated"]},{"data":{"parent":"indexesGroup","id":"com.metaeffekt.mirror.index.nvd.NvdCveApiIndex","label":"<b>NVD CVE API</b><br>nvd-cve / nvdVulnerabilityIndex"},"classes":["graph-node","index"]},{"data":{"parent":"indexesGroup","id":"com.metaeffekt.mirror.index.nvd.NvdCpeApiIndex","label":"<b>NVD CPE API</b><br>cpe-dict / nvdCpeIndex"},"classes":["graph-node","index"]},{"data":{"parent":"indexesGroup","id":"com.metaeffekt.mirror.index.nvd.NvdCpeApiVendorProductIndex","label":"<b>NVD CPE API Vendor Product</b><br>cpe-dict-vp / nvdCpeVendorProductIndex"},"classes":["graph-node","index"]},{"data":{"parent":"indexesGroup","id":"com.metaeffekt.mirror.index.advisor.MsrcProductIndex","label":"<b>MSRC Product</b><br>msrc-products / msrcProductIndex"},"classes":["graph-node","index"]},{"data":{"parent":"indexesGroup","id":"com.metaeffekt.mirror.index.advisor.MsrcAdvisorIndex","label":"<b>MSRC Advisor</b><br>msrc-advisors / msrcAdvisorIndex"},"classes":["graph-node","index"]},{"data":{"parent":"indexesGroup","id":"com.metaeffekt.mirror.index.advisor.MsrcKbChainIndex","label":"<b>MSRC KB Chain</b><br>msrc-kb-chains / msrcKbChainIndex"},"classes":["graph-node","index"]},{"data":{"parent":"indexesGroup","id":"com.metaeffekt.mirror.index.advisor.GhsaAdvisorIndex","label":"<b>GHSA Advisor</b><br>github-advisory-database / githubAdvisorIndex"},"classes":["graph-node","index"]},{"data":{"parent":"indexesGroup","id":"com.metaeffekt.mirror.index.advisor.CertSeiAdvisorIndex","label":"<b>CERT-SEI Advisor</b><br>certsei-advisors / certSeiAdvisorIndex"},"classes":["graph-node","index"]},{"data":{"parent":"indexesGroup","id":"com.metaeffekt.mirror.index.advisor.CertFrAdvisorIndex","label":"<b>CERT-FR Advisor</b><br>certfr-advisors / certFrAdvisorIndex"},"classes":["graph-node","index"]},{"data":{"parent":"indexesGroup","id":"com.metaeffekt.mirror.index.advisor.CertEuAdvisorIndex","label":"<b>CERT-EU Advisor</b><br>certeu-advisors / certEuAdvisorIndex"},"classes":["graph-node","index"]},{"data":{"parent":"indexesGroup","id":"com.metaeffekt.mirror.index.other.KevIndex","label":"<b>KEV</b><br>kev / kevIndex"},"classes":["graph-node","index"]},{"data":{"parent":"indexesGroup","id":"com.metaeffekt.mirror.index.other.EpssIndex","label":"<b>EPSS</b><br>epss / epssIndex"},"classes":["graph-node","index"]},{"data":{"parent":"indexesGroup","id":"com.metaeffekt.mirror.index.other.EolIndex","label":"<b>EOL</b><br>eol / eolIndex"},"classes":["graph-node","index"]},{"data":{"parent":"indexesGroup","id":"com.metaeffekt.mirror.index.nvd.NvdVulnerabilityIndex","label":"<b>NVD Vulnerability</b><br>nvd-cve / nvdLegacyVulnerabilityIndex"},"classes":["graph-node","index","deprecated"]},{"data":{"parent":"indexesGroup","id":"com.metaeffekt.mirror.index.nvd.CpeDictionaryIndex","label":"<b>CPE Dictionary</b><br>cpe-dict / cpeDictionaryIndex"},"classes":["graph-node","index","deprecated"]},{"data":{"parent":"indexesGroup","id":"com.metaeffekt.mirror.index.nvd.CpeDictionaryVendorProductIndex","label":"<b>CPE Dictionary Vendor Product</b><br>cpe-dict-vp / cpeDictionaryVendorProductIndex"},"classes":["graph-node","index","deprecated"]},{"data":{"parent":"indexQueriesGroup","id":"com.metaeffekt.mirror.query.MsrcAdvisorIndexQuery","label":"<b>MSRC Advisor</b>"},"classes":["graph-node","index-query"]},{"data":{"parent":"indexQueriesGroup","id":"com.metaeffekt.mirror.query.MsrcProductIndexQuery","label":"<b>MSRC Product</b>"},"classes":["graph-node","index-query"]},{"data":{"parent":"indexQueriesGroup","id":"com.metaeffekt.mirror.query.CertEuAdvisorIndexQuery","label":"<b>CERT-EU Advisor</b>"},"classes":["graph-node","index-query"]},{"data":{"parent":"indexQueriesGroup","id":"com.metaeffekt.mirror.query.CustomVulnerabilityIndexQuery","label":"<b>Custom Vulnerability</b>"},"classes":["graph-node","index-query"]},{"data":{"parent":"indexQueriesGroup","id":"com.metaeffekt.mirror.query.GhsaAdvisorIndexQuery","label":"<b>GHSA Advisor</b>"},"classes":["graph-node","index-query"]},{"data":{"parent":"indexQueriesGroup","id":"com.metaeffekt.mirror.query.NvdCpeApiIndexQuery","label":"<b>NVD CPE API</b>"},"classes":["graph-node","index-query"]},{"data":{"parent":"indexQueriesGroup","id":"com.metaeffekt.mirror.query.KevIndexQuery","label":"<b>KEV</b>"},"classes":["graph-node","index-query"]},{"data":{"parent":"indexQueriesGroup","id":"com.metaeffekt.mirror.query.MsrcKbChainIndexQuery","label":"<b>MSRC KB Chain</b>"},"classes":["graph-node","index-query"]},{"data":{"parent":"indexQueriesGroup","id":"com.metaeffekt.mirror.query.EpssIndexQuery","label":"<b>EPSS</b>"},"classes":["graph-node","index-query"]},{"data":{"parent":"indexQueriesGroup","id":"com.metaeffekt.mirror.query.NvdCpeApiVendorProductIndexQuery","label":"<b>NVD CPE API Vendor Product</b>"},"classes":["graph-node","index-query"]},{"data":{"parent":"indexQueriesGroup","id":"com.metaeffekt.mirror.query.EolIndexQuery","label":"<b>EOL</b>"},"classes":["graph-node","index-query"]},{"data":{"parent":"indexQueriesGroup","id":"com.metaeffekt.mirror.query.CertFrAdvisorIndexQuery","label":"<b>CERT-FR Advisor</b>"},"classes":["graph-node","index-query"]},{"data":{"parent":"indexQueriesGroup","id":"com.metaeffekt.mirror.query.CertSeiAdvisorIndexQuery","label":"<b>CERT-SEI Advisor</b>"},"classes":["graph-node","index-query"]},{"data":{"parent":"indexQueriesGroup","id":"com.metaeffekt.mirror.query.NvdCveIndexQuery","label":"<b>NVD CVE</b>"},"classes":["graph-node","index-query"]},{"data":{"parent":"indexQueriesGroup","id":"com.metaeffekt.mirror.query.CpeDictionaryVendorProductIndexQuery","label":"<b>CPE Dictionary Vendor Product</b>"},"classes":["graph-node","index-query","deprecated"]},{"data":{"parent":"indexQueriesGroup","id":"com.metaeffekt.mirror.query.CpeDictionaryIndexQuery","label":"<b>CPE Dictionary</b>"},"classes":["graph-node","index-query","deprecated"]},{"data":{"parent":"phaseGroup_PRODUCT_IDENTIFICATION","id":"com.metaeffekt.artifact.enrichment.vulnerability.CpeDerivationEnrichment","label":"<b>CPE URI derivation</b><br>cpe-derived / cpeDerivationEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_PRODUCT_IDENTIFICATION","id":"com.metaeffekt.artifact.enrichment.other.ArtifactCorrelationEnrichment","label":"<b>Artifact Correlation YAML</b><br>correlation / correlationYamlEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_VULNERABILITY_MATCHING","id":"com.metaeffekt.artifact.enrichment.matching.NvdVulnerabilitiesFromCpeEnrichment","label":"<b>NVD CVE from CPE</b><br>nvd-cve-from-cpe / nvdMatchCveFromCpeEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_VULNERABILITY_MATCHING","id":"com.metaeffekt.artifact.enrichment.matching.MsrcVulnerabilitiesByProductEnrichment","label":"<b>MSRC Vulnerabilities by Products</b><br>msrc-cve-from-product / msVulnerabilitiesByProductEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_VULNERABILITY_MATCHING","id":"com.metaeffekt.artifact.enrichment.vulnerability.ghsa.GhsaVulnerabilitiesEnrichment","label":"<b>GHSA Vulnerabilities</b><br>ghsa-cve / ghsaVulnerabilitiesEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_VULNERABILITY_MATCHING","id":"com.metaeffekt.artifact.enrichment.matching.CustomVulnerabilitiesFromCpeEnrichment","label":"<b>Custom Vulnerabilities from CPE</b><br>custom-vulnerabilities-from-cpe / customVulnerabilitiesFromCpeEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_VULNERABILITY_DETAILS_FILLING","id":"com.metaeffekt.artifact.enrichment.details.DetailsFillingEnrichmentNvd","label":"<b>NVD Vulnerability Details</b><br>details-vulnerability-nvd / nvdCveFillDetailsEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_VULNERABILITY_DETAILS_FILLING","id":"com.metaeffekt.artifact.enrichment.details.DetailsFillingEnrichmentMsrc","label":"<b>MSRC Vulnerability Details</b><br>details-vulnerability-msrc / msrcAdvisorFillDetailsEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_VULNERABILITY_DETAILS_FILLING","id":"com.metaeffekt.artifact.enrichment.details.DetailsFillingEnrichmentCustom","label":"<b>Custom Vulnerability Details</b><br>details-vulnerability-custom / customVulnerabilitiesFillDetailsEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_ASSESSMENTS","id":"com.metaeffekt.artifact.enrichment.vulnerability.VulnerabilityStatusEnrichment","label":"<b>Vulnerability Status</b><br>status / vulnerabilityStatusEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_ASSESSMENTS","id":"com.metaeffekt.artifact.enrichment.vulnerability.VulnerabilityKeywordsEnrichment","label":"<b>Vulnerability Keywords</b><br>vulnerability-keywords / vulnerabilityKeywordsEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_SECURITY_ADVISORY_MATCHING","id":"com.metaeffekt.artifact.enrichment.details.DetailsFillingEnrichmentGhsa","label":"<b>GHSA Vulnerability Details</b><br>details-vulnerability-ghsa / ghsaAdvisorFillDetailsEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_SECURITY_ADVISORY_MATCHING","id":"com.metaeffekt.artifact.enrichment.details.DetailsFillingEnrichmentCertFr","label":"<b>CERT-FR Advisor Details</b><br>details-advisor-cert-fr / certFrAdvisorEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_SECURITY_ADVISORY_MATCHING","id":"com.metaeffekt.artifact.enrichment.details.DetailsFillingEnrichmentCertSei","label":"<b>CERT-SEI Advisor Details</b><br>details-advisor-cert-sei / certSeiAdvisorEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_SECURITY_ADVISORY_MATCHING","id":"com.metaeffekt.artifact.enrichment.details.DetailsFillingEnrichmentCertEu","label":"<b>CERT-EU Advisor Details</b><br>details-advisor-cert-eu / certEuAdvisorEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_VULNERABILITY_PRIORITIZATION","id":"com.metaeffekt.artifact.enrichment.other.EolEnrichment","label":"<b>EOL Date</b><br>eol-date / eolEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_VULNERABILITY_PRIORITIZATION","id":"com.metaeffekt.artifact.enrichment.other.EpssEnrichment","label":"<b>EPSS Enrichment</b><br>epss / epssEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_VULNERABILITY_PRIORITIZATION","id":"com.metaeffekt.artifact.enrichment.other.KevEnrichment","label":"<b>KEV Enrichment</b><br>kev / kevEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_INVENTORY_POST_PROCESSING","id":"com.metaeffekt.artifact.enrichment.vulnerability.VulnerabilityStatusPostProcessingEnrichment","label":"<b>Vulnerability Status Post Processing</b><br>status-post-processed / vulnerabilityStatusPostProcessingEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_INVENTORY_POST_PROCESSING","id":"com.metaeffekt.artifact.enrichment.vulnerability.VulnerabilityFilterEnrichment","label":"<b>Vulnerability Filtering</b><br>vulnerability-filter / vulnerabilityFilterEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_INVENTORY_POST_PROCESSING","id":"com.metaeffekt.artifact.enrichment.validation.InventoryValidationEnrichment","label":"<b>Inventory Validation</b><br>inventory-validation / inventoryValidationEnrichment"},"classes":["graph-node","enricher"]},{"data":{"parent":"phaseGroup_REPORTING","id":"com.metaeffekt.artifact.enrichment.other.vad.VulnerabilityAssessmentDashboard","label":"<b>Vulnerability Assessment Dashboard</b><br>vulnerability-assessment-dashboard / vulnerabilityAssessmentDashboardEnrichment"},"classes":["graph-node","enricher"]}];

    var edges = [{"data":{"source":"com.metaeffekt.mirror.download.nvd.NvdCveApiDownload","label":"Download","target":"com.metaeffekt.mirror.index.nvd.NvdCveApiIndex"}},{"data":{"source":"com.metaeffekt.mirror.download.nvd.NvdCpeApiDownload","label":"Download","target":"com.metaeffekt.mirror.index.nvd.NvdCpeApiIndex"}},{"data":{"source":"com.metaeffekt.mirror.index.nvd.NvdCpeApiIndex","label":"Index","target":"com.metaeffekt.mirror.index.nvd.NvdCpeApiVendorProductIndex"}},{"data":{"source":"com.metaeffekt.mirror.download.advisor.MsrcDownload","label":"Download","target":"com.metaeffekt.mirror.index.advisor.MsrcProductIndex"}},{"data":{"source":"com.metaeffekt.mirror.download.advisor.MsrcDownload","label":"Download","target":"com.metaeffekt.mirror.index.advisor.MsrcAdvisorIndex"}},{"data":{"source":"com.metaeffekt.mirror.download.advisor.MsrcSecurityGuideDownload","label":"Download","target":"com.metaeffekt.mirror.index.advisor.MsrcKbChainIndex"}},{"data":{"source":"com.metaeffekt.mirror.index.advisor.MsrcAdvisorIndex","label":"Index","target":"com.metaeffekt.mirror.index.advisor.MsrcKbChainIndex"}},{"data":{"source":"com.metaeffekt.mirror.index.advisor.MsrcProductIndex","label":"Index","target":"com.metaeffekt.mirror.index.advisor.MsrcKbChainIndex"}},{"data":{"source":"com.metaeffekt.mirror.download.advisor.MsrcManualCsvDownload","label":"Optional Download","target":"com.metaeffekt.mirror.index.advisor.MsrcKbChainIndex"}},{"data":{"source":"com.metaeffekt.mirror.download.advisor.GhsaDownload","label":"Download","target":"com.metaeffekt.mirror.index.advisor.GhsaAdvisorIndex"}},{"data":{"source":"com.metaeffekt.mirror.download.advisor.CertSeiDownload","label":"Download","target":"com.metaeffekt.mirror.index.advisor.CertSeiAdvisorIndex"}},{"data":{"source":"com.metaeffekt.mirror.download.advisor.CertFrDownload","label":"Download","target":"com.metaeffekt.mirror.index.advisor.CertFrAdvisorIndex"}},{"data":{"source":"com.metaeffekt.mirror.download.advisor.CertEuDownload","label":"Download","target":"com.metaeffekt.mirror.index.advisor.CertEuAdvisorIndex"}},{"data":{"source":"com.metaeffekt.mirror.download.other.CisaKevDownload","label":"Download","target":"com.metaeffekt.mirror.index.other.KevIndex"}},{"data":{"source":"com.metaeffekt.mirror.download.other.EpssDownload","label":"Download","target":"com.metaeffekt.mirror.index.other.EpssIndex"}},{"data":{"source":"com.metaeffekt.mirror.download.other.EolDownload","label":"Download","target":"com.metaeffekt.mirror.index.other.EolIndex"}},{"data":{"source":"com.metaeffekt.mirror.download.nvd.NvdDownload","label":"Download","target":"com.metaeffekt.mirror.index.nvd.NvdVulnerabilityIndex"}},{"data":{"source":"com.metaeffekt.mirror.download.nvd.CpeDictionaryDownload","label":"Download","target":"com.metaeffekt.mirror.index.nvd.CpeDictionaryIndex"}},{"data":{"source":"com.metaeffekt.mirror.index.nvd.CpeDictionaryIndex","label":"Index","target":"com.metaeffekt.mirror.index.nvd.CpeDictionaryVendorProductIndex"}},{"data":{"source":"com.metaeffekt.mirror.query.NvdCpeApiIndexQuery","target":"com.metaeffekt.artifact.enrichment.vulnerability.CpeDerivationEnrichment"}},{"data":{"source":"com.metaeffekt.mirror.query.NvdCpeApiVendorProductIndexQuery","target":"com.metaeffekt.artifact.enrichment.vulnerability.CpeDerivationEnrichment"}},{"data":{"source":"com.metaeffekt.mirror.query.NvdCveIndexQuery","target":"com.metaeffekt.artifact.enrichment.matching.NvdVulnerabilitiesFromCpeEnrichment"}},{"data":{"source":"com.metaeffekt.mirror.query.MsrcProductIndexQuery","target":"com.metaeffekt.artifact.enrichment.matching.MsrcVulnerabilitiesByProductEnrichment"}},{"data":{"source":"com.metaeffekt.mirror.query.MsrcAdvisorIndexQuery","target":"com.metaeffekt.artifact.enrichment.matching.MsrcVulnerabilitiesByProductEnrichment"}},{"data":{"source":"com.metaeffekt.mirror.query.MsrcKbChainIndexQuery","target":"com.metaeffekt.artifact.enrichment.matching.MsrcVulnerabilitiesByProductEnrichment"}},{"data":{"source":"com.metaeffekt.mirror.query.GhsaAdvisorIndexQuery","target":"com.metaeffekt.artifact.enrichment.vulnerability.ghsa.GhsaVulnerabilitiesEnrichment"}},{"data":{"source":"com.metaeffekt.mirror.query.CustomVulnerabilityIndexQuery","target":"com.metaeffekt.artifact.enrichment.matching.CustomVulnerabilitiesFromCpeEnrichment"}},{"data":{"source":"com.metaeffekt.mirror.query.NvdCveIndexQuery","target":"com.metaeffekt.artifact.enrichment.details.DetailsFillingEnrichmentNvd"}},{"data":{"source":"com.metaeffekt.mirror.query.MsrcAdvisorIndexQuery","target":"com.metaeffekt.artifact.enrichment.details.DetailsFillingEnrichmentMsrc"}},{"data":{"source":"com.metaeffekt.mirror.query.MsrcKbChainIndexQuery","target":"com.metaeffekt.artifact.enrichment.details.DetailsFillingEnrichmentMsrc"}},{"data":{"source":"com.metaeffekt.mirror.query.GhsaAdvisorIndexQuery","target":"com.metaeffekt.artifact.enrichment.details.DetailsFillingEnrichmentGhsa"}},{"data":{"source":"com.metaeffekt.mirror.query.CertFrAdvisorIndexQuery","target":"com.metaeffekt.artifact.enrichment.details.DetailsFillingEnrichmentCertFr"}},{"data":{"source":"com.metaeffekt.mirror.query.CertSeiAdvisorIndexQuery","target":"com.metaeffekt.artifact.enrichment.details.DetailsFillingEnrichmentCertSei"}},{"data":{"source":"com.metaeffekt.mirror.query.CertEuAdvisorIndexQuery","target":"com.metaeffekt.artifact.enrichment.details.DetailsFillingEnrichmentCertEu"}},{"data":{"source":"com.metaeffekt.mirror.query.CustomVulnerabilityIndexQuery","target":"com.metaeffekt.artifact.enrichment.details.DetailsFillingEnrichmentCustom"}},{"data":{"source":"com.metaeffekt.mirror.query.EolIndexQuery","target":"com.metaeffekt.artifact.enrichment.other.EolEnrichment"}},{"data":{"source":"com.metaeffekt.mirror.query.EpssIndexQuery","target":"com.metaeffekt.artifact.enrichment.other.EpssEnrichment"}},{"data":{"source":"com.metaeffekt.mirror.query.KevIndexQuery","target":"com.metaeffekt.artifact.enrichment.other.KevEnrichment"}},{"data":{"source":"com.metaeffekt.mirror.query.MsrcProductIndexQuery","target":"com.metaeffekt.artifact.enrichment.vulnerability.VulnerabilityStatusPostProcessingEnrichment"}},{"data":{"source":"com.metaeffekt.mirror.query.GhsaAdvisorIndexQuery","target":"com.metaeffekt.artifact.enrichment.vulnerability.VulnerabilityStatusPostProcessingEnrichment"}},{"data":{"source":"com.metaeffekt.mirror.query.NvdCpeApiIndexQuery","target":"com.metaeffekt.artifact.enrichment.validation.InventoryValidationEnrichment"}},{"data":{"source":"com.metaeffekt.mirror.query.NvdCveIndexQuery","target":"com.metaeffekt.artifact.enrichment.other.vad.VulnerabilityAssessmentDashboard"}},{"data":{"source":"com.metaeffekt.mirror.query.NvdCpeApiIndexQuery","target":"com.metaeffekt.artifact.enrichment.other.vad.VulnerabilityAssessmentDashboard"}},{"data":{"source":"com.metaeffekt.mirror.query.MsrcProductIndexQuery","target":"com.metaeffekt.artifact.enrichment.other.vad.VulnerabilityAssessmentDashboard"}},{"data":{"source":"com.metaeffekt.mirror.index.advisor.MsrcAdvisorIndex","target":"com.metaeffekt.mirror.query.MsrcAdvisorIndexQuery"}},{"data":{"source":"com.metaeffekt.mirror.index.advisor.MsrcProductIndex","target":"com.metaeffekt.mirror.query.MsrcProductIndexQuery"}},{"data":{"source":"com.metaeffekt.mirror.index.advisor.CertEuAdvisorIndex","target":"com.metaeffekt.mirror.query.CertEuAdvisorIndexQuery"}},{"data":{"source":"com.metaeffekt.mirror.index.advisor.GhsaAdvisorIndex","target":"com.metaeffekt.mirror.query.GhsaAdvisorIndexQuery"}},{"data":{"source":"com.metaeffekt.mirror.index.nvd.NvdCpeApiIndex","target":"com.metaeffekt.mirror.query.NvdCpeApiIndexQuery"}},{"data":{"source":"com.metaeffekt.mirror.index.other.KevIndex","target":"com.metaeffekt.mirror.query.KevIndexQuery"}},{"data":{"source":"com.metaeffekt.mirror.index.advisor.MsrcKbChainIndex","target":"com.metaeffekt.mirror.query.MsrcKbChainIndexQuery"}},{"data":{"source":"com.metaeffekt.mirror.index.other.EpssIndex","target":"com.metaeffekt.mirror.query.EpssIndexQuery"}},{"data":{"source":"com.metaeffekt.mirror.index.nvd.NvdCpeApiVendorProductIndex","target":"com.metaeffekt.mirror.query.NvdCpeApiVendorProductIndexQuery"}},{"data":{"source":"com.metaeffekt.mirror.index.other.EolIndex","target":"com.metaeffekt.mirror.query.EolIndexQuery"}},{"data":{"source":"com.metaeffekt.mirror.index.advisor.CertFrAdvisorIndex","target":"com.metaeffekt.mirror.query.CertFrAdvisorIndexQuery"}},{"data":{"source":"com.metaeffekt.mirror.index.advisor.CertSeiAdvisorIndex","target":"com.metaeffekt.mirror.query.CertSeiAdvisorIndexQuery"}},{"data":{"source":"com.metaeffekt.mirror.index.nvd.NvdCveApiIndex","target":"com.metaeffekt.mirror.query.NvdCveIndexQuery"}},{"data":{"source":"com.metaeffekt.mirror.index.nvd.CpeDictionaryVendorProductIndex","target":"com.metaeffekt.mirror.query.CpeDictionaryVendorProductIndexQuery"}},{"data":{"source":"com.metaeffekt.mirror.index.nvd.CpeDictionaryIndex","target":"com.metaeffekt.mirror.query.CpeDictionaryIndexQuery"}}];

    var cy = cytoscape({
        container: document.getElementById('cy'),

        elements: elements.concat(edges),

        style: [
            {
                selector: 'node',
                style: {
                    'label': '',
                    'text-valign': 'top',
                    'text-halign': 'left',
                    'shape': 'rectangle',
                    'background-color': '#FFFFFF',
                    'border-width': 1,
                    'border-color': '#000',
                    'font-size': 12,
                    'width': '360px',
                    'padding-left': '10px',
                    'padding-right': '10px',
                    'text-wrap': 'wrap',
                }
            },
            {
                selector: 'node.downloader',
                style: {
                    'height': '40px',
                }
            },
            {
                selector: 'node.index',
                style: {
                    'height': '40px',
                }
            },
            {
                selector: 'node.index-query',
                style: {
                    'height': '23px',
                    'width': '220px',
                }
            },
            {
                selector: 'node.enricher',
                style: {
                    'height': '40px',
                    'width': '500px',
                }
            },
            {
                selector: '$node > node', // parent nodes (compound nodes)
                style: {
                    'background-color': '#E0E0E0',
                    'shape': 'rectangle',
                    'padding': '20px',
                    'text-valign': 'top',
                    'text-halign': 'center',
                    'font-weight': 'bold',
                    'font-size': 14,
                    'border-width': 1,
                    'border-color': '#000',
                }
            },
            {
                selector: 'node[parent="downloadersGroup"]',
                style: {
                    'background-color': '#FFDAB9'
                }
            },
            {
                selector: 'node[parent="indexesGroup"]',
                style: {
                    'background-color': '#E6E6FA'
                }
            },
            {
                selector: 'node[parent="indexQueriesGroup"]',
                style: {
                    'background-color': '#FFFACD'
                }
            },
            {
                selector: 'node[parent="phase1Group"]',
                style: {
                    'background-color': '#D0D0F5'
                }
            },
            {
                selector: 'node[parent="phase2Group"]',
                style: {
                    'background-color': '#F0D0F5'
                }
            },
            {
                selector: 'node[parent="phase3Group"]',
                style: {
                    'background-color': '#D0F0F5'
                }
            },
            {
                selector: 'edge',
                style: {
                    'width': 2,
                    'line-color': '#545454',
                    'target-arrow-shape': 'triangle',
                    'target-arrow-color': '#545454',
                    'curve-style': 'bezier'
                }
            },
            {
                selector: '.deprecated',
                style: {
                    'border-color': '#ff6767',
                    'border-width': 3,
                }
            }
        ],

        layout: {
            name: 'dagre',
            rankDir: 'LR',
            nodeSep: 60,
            edgeSep: 10,
            rankSep: 100,
            padding: 20
        }
    });

    // initialize the node HTML labels as separate dom elements instead of using the default cytoscape labels
    cy.nodeHtmlLabel([
        {
            query: '.graph-container',
            halign: 'center',
            valign: 'top',
            halignBox: 'center',
            valignBox: 'top',
            cssClass: '',
            tpl: function (data) {
                return data.label;
            }
        },
        {
            query: '.graph-node',
            halign: 'left',
            valign: 'center',
            halignBox: 'right',
            valignBox: 'center',
            cssClass: '',
            tpl: function (data) {
                return data.label;
            }
        }
    ]);


    function download(filename, dataUrl) {
        const element = document.createElement('a');
        element.setAttribute('href', dataUrl);
        element.setAttribute('download', filename);

        document.body.appendChild(element);
        element.click();
        document.body.removeChild(element);
    }

    document.addEventListener('keydown', function (event) {
        if (event.key === 's' || event.key === 'S') {
            domtoimage.toSvg(document.getElementById('cy'))
                .then(function (dataUrl) {
                    download('large-overview-diagram.svg', dataUrl);
                })
                .catch(function (error) {
                    console.error('Error capturing SVG:', error);
                    alert('Check the console for an error message.');
                });
        }
    });

    document.addEventListener('keydown', function (event) {
        if (event.key === 'p' || event.key === 'P') {
            html2canvas(document.querySelector('#cy'), {scale: 3}).then(canvas => {
                var imageData = canvas.toDataURL('image/png');

                download('large-overview-diagram.png', imageData);
            });
        }
    });
</script>

</body>
</html>
