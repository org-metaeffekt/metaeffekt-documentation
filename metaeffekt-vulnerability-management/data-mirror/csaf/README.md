# CSAF 

## Overview

- [What is CSAF](#what-is-csaf)
- [CSAF Advisory](#csaf-advisory)
- [Roles](#roles)
- [Role Requirements](#role-requirements)
- [Profiles](#profiles)
  - [CSAF-Base](#csaf-base)
  - [VEX](#vex)
- [Matching](#matching)
- [CSAF Vulnerability Matching](#csaf-vulnerability-matching)


## What is CSAF

* CSAF is maintained by OASIS (Organization for the Advancement of Structured Information Standards).
* CSAF is a JSON-based format for providing and sharing structured security advisories or vulnerabilities, their impact and ways to mitigate them.
* By using CSAF, different organizations and tools can easily integrate new data sources and get more information/context. But also, to be the most effective, it has to be adopted across the industry and multiple organizations.
* A CSAF document contains information like the title, type of advisory, publisher, references to related vulnerabilities (like CVEs), and details about them (like severity, impact, and solutions). Often, they also provide CVSS vectors that can be used to calculate CVSS scores.

## CSAF Advisory

![CsafAdvisoryIndex](individual-detail-overview-diagram-rendered/individual-detail-overview-diagram-CsafAdvisoryIndex.png)

## Roles
| Role                          | Description                                                                                                                                                                                                                                                                    | Responsibilities                                                                                                                                                                                                                                                           |
|:------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Publisher**                 | A CSAF Publisher is the initial source of a security advisory, usually represented by organizations that are issuing advisories about vulnerabilities in their own products or services. They do not distribute advisories from other sources.                                 | - Distributes CSAF documents on behalf of its own organization <br/> - Must satisfy requirements 1 to 4.                                                                                                                                                                   |
| **Provider**                  | A CSAF Provider is more involved compared to a CSAF Publisher, also publishing advisories, whilst also distributing them and making them accessible. Distribution methods include directory-based or ROLIE-based (Resource-Oriented Lightweight Information Exchange) methods. | - Fulfills all the roles of a CSAF Publisher. <br/> - Additionally meets requirements 5 to 7, and at least one of the requirements 8 to 10. <br/> - Must also satisfy requirements 11 to 14 (for directory-based distribution) or 15 to 17 (for ROLIE-based distribution). |
| **Trusted Provider**          | This role is a step above a CSAF Provider, offering a higher level of trust and reliability in the advisories they issue, likely through more stringent verification and validation processes.                                                                                 | - Meets all the criteria of a CSAF Provider. <br/> - Additionally satisfies requirements 18 to 20.                                                                                                                                                                         |
| **Lister**                    | The CSAF Lister compiles and provides lists of URLs where CSAF documents can be found. They don't host the advisories themselves but direct users to where they can be accessed.                                                                                               | Meets requirements 6, 21, and 22. <br/> - Uses the value 'lister' for `/aggregator/category`. <br/> - Does not list any mirror pointing to a domain under its own control.                                                                                                 |
| **Aggregator**                | CSAF Aggregators serve as a centralized point for accessing CSAF documents from multiple sources. They may mirror documents from CSAF Publishers and provide additional verification (like signatures and hashes) to ensure the integrity of the documents.                    | Satisfies requirements 1 to 6 and 21 to 23. <br/> - Uses the value 'aggregator' for `/aggregator/category`. <br/> - Lists a mirror for at least two disjoint issuing parties. <br/> - Provides signatures and hashes for mirrored documents.                               |


## Role Requirements
| Requirement | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Roles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|:------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1           | The document must be a valid CSAF document.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Publisher, Provider, Trusted Provider, Aggregator                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 2           | The CSAF document must have a filename according to the rules in section 5.1.  <br/> 1.Lowercase Conversion: The value in `/document/tracking/id` of the CSAF document is converted entirely into lowercase. <br/> 2.Character Replacement:After converting to lowercase, the filename must only include certain characters `([^+\-a-z0-9]+)`. Any character sequence not part of the following groups is replaced by a single underscore (_):  <br/> - Lowercase ASCII letters (ranging from 0x61 to 0x7A in hexadecimal notation). <br/> - Digits (0x30 to 0x39). <br/> - Special characters: plus (+, 0x2B) and hyphen (-, 0x2D). <br/> Notably, even if an underscore (_) is a valid character, it is also replaced to avoid multiple consecutive underscores in the filename. For example, an ID like `2022_#01-A` would be converted to `2022_01-a `instead of `2022__01-a`, ensuring a cleaner and more readable filename. 3.File Extension: The file extension `.json` is appended to the end of the filename. 4.Indicating Invalid Documents: If a CSAF document is invalid, the practice is to indicate this by inserting _invalid into the filename, just before the `.json` extension. This practice helps in quickly identifying `invalid` documents without having to open or parse them. For example: `example_company_-_2019-yh3234_invalid.json.` | Publisher, Provider, Trusted Provider, Aggregator                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 3           | The CSAF document must be retrievable from a website using TLS for encryption and server authenticity.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Publisher, Provider, Trusted Provider, Aggregator                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 4           | If labeled `TLP:WHITE`, the CSAF document must be freely accessible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Publisher, Provider, Trusted Provider, Aggregator                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 5           | CSAF documents labeled `TLP:AMBER` or `TLP:RED` must be access protected.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Provider, Trusted Provider, Aggregator                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 6           | Redirects should not be used for CSAF document retrieval; if inevitable, only HTTP Header redirects are allowed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Provider, Trusted Provider, Lister, Aggregator                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 7           | A valid `provider-metadata.json` must be provided according to the CSAF provider metadata schema.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Provider, Trusted Provider                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 8           | The `security.txt` must include at least one field pointing to the `provider-metadata.json`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | (Provider one of), (Trusted Provider one of)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| 9           | The URL path `/.well-known/csaf/provider-metadata.json` under the main domain must serve the `provider-metadata.json`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | (Provider one of), (Trusted Provider one of)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| 10          | The DNS record `csaf.data.security.domain.tld` must resolve as a web server serving the `provider-metadata.json`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | (Provider one of), (Trusted Provider one of)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| 11          | CSAF documents must be located within folders named by the year of the initial release date.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | (Provider directory-based),(Trusted Provider directory-based)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 12          | An `index.txt` file must provide a list of all filenames of CSAF documents in the sub-directories.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | (Provider directory-based),(Trusted Provider directory-based)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 13          | A `changes.csv` file must contain the filename and current release date for each CSAF document.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | (Provider directory-based),(Trusted Provider directory-based)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 14          | Directory listing should be enabled to support manual navigation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | (Provider directory-based),(Trusted Provider directory-based)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 15          | All CSAF documents with the same TLP level must be listed in a single ROLIE feed.At least one of `TLP:WHITE`, `TLP:GREEN`, `unlabeled` MUST exis                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | (Provider ROLIE-based),(Trusted Provider ROLIE-based)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 16          | The use of a ROLIE service document is optional.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | (Provider ROLIE-based),(Trusted Provider ROLIE-based)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 17          | The use of a ROLIE category document is optional.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | (Provider ROLIE-based),(Trusted Provider ROLIE-based)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 18          | All CSAF documents must have at least one hash file computed with a secure cryptographic hash algorithm.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Trusted Provider                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 19          | All CSAF documents must have at least one OpenPGP signature file.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Trusted Provider                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 20          | The public part of the OpenPGP key used to sign CSAF documents must be available.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Trusted Provider                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 21          | A file `aggregator.json` must be present and valid according to the CSAF aggregator schema.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Lister, Aggregator                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 22          | The `aggregator.json` must list at least two disjoint CSAF providers or one CSAF publisher and one CSAF provider.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Lister, Aggregator                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 23          | CSAF documents for each mirrored issuing party must be in a different folder adjacent to the `aggregator.json.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Aggregator                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |


## Profiles
CSAF documents do not have many required fields as they can be used for different purposes. To ensure a common understanding of which fields are required in a given use case the standard defines profiles. Each subsection describes such a profile by describing necessary content for that specific use case and providing insights into its purpose. The value of /document/category` is used to identify a CSAF document's profile. The following rules apply:
1. Each CSAF document MUST conform the CSAF Base profile.
2. Each profile extends the base profile "CSAF Base" - directly or indirect through another profile from the standard - by making additional fields from the standard mandatory. A profile can always add, but never subtract nor overwrite requirements defined in the profile it extends.
3. Any optional field from the standard can also be added to a CSAF document which conforms with a profile without breaking conformance with the profile. One and only exempt is when the profile requires not to have a certain set of fields.
4. Values of `/document/category` starting with `csaf_` are reserved for existing, upcoming and future profiles defined in the CSAF standard.
5. Values of `/document/category` that do not match any of the values defined in section 4 of this standard SHALL be validated against the "CSAF Base" profile.
6. Local or private profiles MAY exist and tools MAY choose to support them. 
7. If an official profile and a private profile exists, tools MUST validate against the official one from the standard.


### CSAF-Base
This profile defines the default required fields for any CSAF document. Therefore, it is a "catch all" for CSAF documents that do not satisfy any other profile. Furthermore, it is the foundation all other profiles are build on.

A CSAF document shall fulfill the following requirements to satisfy the profile "CSAF Base":

The following elements MUST exist and be valid:

- `/document/category`
- `/document/csaf_version`
- `/document/publisher/category`
- `/document/publisher/name`
- `/document/publisher/namespace`
- `/document/title`
- `/document/tracking/current_release_date`
- `/document/tracking/id`
- `/document/tracking/initial_release_date`
- `/document/tracking/revision_history[]/date`
- `/document/tracking/revision_history[]/number`
- `/document/tracking/revision_history[]/summary`
- `/document/tracking/status`
- `/document/tracking/version`

The value of `/document/category` shall not be equal to any value that is intended to only be used by another profile nor to the (case insensitive) name of any other profile from the standard. This does not differentiate between underscore, dash or whitespace. To explicitly select the use of this profile the value `csaf_base` should be used.
Neither `CSAF Security Advisory`nor `csaf security advisory` are valid values for `/document/category`.


### VEX 
The goal of Vulnerability Exploitability eXchange (VEX) is to allow a software supplier or other parties to assert the status of specific vulnerabilities in a particular product.

VEX has been implemented as a profile in the Common Security Advisory Framework (CSAF).

[] CVRF [includes] different profiles (e.g., CSAF Base, Informational Advisory, Incident Response, VEX, etc.). Each profile extends the base profile "CSAF Base" - directly or indirect through another profile from the standard - by making additional fields from the standard mandatory. 
A profile can always add, but never subtract nor overwrite requirements defined in the profile it extends.

The primary use cases for VEX are to provide users (e.g., operators, developers, and services providers) additional information on whether
a product is impacted by a specific vulnerability in an included component and, if affected, whether there are actions recommended to remediate.

To reduce effort spent by users investigating non-exploitable vulnerabilities that dont affect a software product, suppliers can issue a VEX. A VEX is an assertion about the status of a vulnerability in specific products. 
The status can be:

- Not affected  No remediation is required regarding this vulnerability.
- Affected  Actions are recommended to remediate or address this vulnerability.
- Fixed  Represents that these product versions contain a fix for the vulnerability.
- Under Investigation  It is not yet known whether these product versions are affected by the vulnerability. An update will be provided in a later release.


A CSAF document shall fulfill the following requirements to satisfy the profile "VEX":

- The following elements must exist and be valid:
  - all elements required by the profile "CSAF Base".
  - `/product_tree` which lists all products referenced later on in the CSAF document regardless of their state.
  - `/vulnerabilities which lists all vulnerabilities.
  - at least one of 
    - `/vulnerabilities[]/product_status/fixed` 
    - `/vulnerabilities[]/product_status/known_affected` 
    - `/vulnerabilities[]/product_status/known_not_affected`  
    - `/vulnerabilities[]/product_status/under_investigation`
  - at least one of 
    - `/vulnerabilities[]/cve` 
    - `/vulnerabilities[]/ids` 
    - `/vulnerabilities[]/notes`

Provides details about the vulnerability.

- For each item in
  - `/vulnerabilities[]/product_status/known_not_affected` an impact statement shall exist as machine-readable flag in `/vulnerabilities[]/flags`or as human-readable justification in `/vulnerabilities[]/threats`. 
     For the latter one, the category value for such a statement must be `impact` and the details` field shall contain a description why the vulnerability cannot be exploited.
  - `/vulnerabilities[]/product_status/known_affected` additional product specific information shall be provided in `/vulnerabilities[]/remediations` as an action statement. Optional, additional information may also be provided through `/vulnerabilities[]/notes` and `/vulnerabilities[]/threats`. 
   
 The use of the categories `no_fix_planned` and `none_available for an action statement is permitted.


Even though Product status lists Product IDs, Product Group IDs can be used in the `remediations` and `threats object`. 
However, it must be ensured that for each Product ID the required information according to its product status as stated in the two points above is available. This implies that all products with the status `known_not_affected` must have an impact statement and all products with the status `known_affected` must have additional product specific information regardless of whether that is referenced through the Product ID or a Product Group ID.

- The value of `/document/category` shall be `csaf_vex`.


## Matching 
The CSAF data model adds another step in between your products and the vulnerabilities that are to be matched, which is to first find the affected products to then use them in the other structure to find the applicable vulnerabilities.

1. Identification of `product_ids` from `/product_tree/branches/.../product_id` by evaluating the `branches` with your products.
2. Use the product_ids` to find applicable vulnerabilities.

## CSAF Vulnerability Matching

![CsafVulnerabilityMatchingIndex](individual-detail-overview-diagram-rendered/individual-detail-overview-diagram-CsafVulnerabilityMatchingIndex.png)
