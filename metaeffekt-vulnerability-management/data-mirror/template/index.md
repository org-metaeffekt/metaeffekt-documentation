> [Documentation](../../README.md) >
> [Vulnerability Management](../vulnerability-management.md) >
> [Vulnerability Data Mirror](vulnerability-data-mirror.md) >
> Indexers

# Indexers

> [Overview](#overview) -
> [POM Configuration](#pom-configuration) -
> [Indexing Workflow](#indexing-workflow) -
> [Indexers Details](#indexers-details)

## Overview

The indexers extract and process data from the downloads, organizing it into searchable formats for further use.
Each indexer processes data differently depending on the structure and type of data received from its associated
downloads.
A detailed overview of the dependencies between downloads and indexes is available on the individual index chapters
as seen below.

$gen{index-list-active}

An overview diagram for all available downloaders, indexers, and enrichers is available in the
[Large Overview Diagram](../../diagrams/individual-index-diagrams.md) chapter.

#### Deprecated Downloaders

$gen{index-list-deprecated}

## POM Configuration

The downloader configuration is part of the `ae-mirror-plugin` configuration in the Maven POM.
An example configuration with all available indexers is provided below.

<details>

<summary>Click to show the full POM configuration</summary>

```xml
<plugins>
    <plugin>
        <groupId>com.metaeffekt.artifact.analysis</groupId>
        <artifactId>ae-mirror-plugin</artifactId>
        <version>${ae.artifact.analysis.version}</version>

        <executions>
            <execution>
                <id>data-mirror-index</id>
                <goals>
                    <goal>data-mirror</goal>
                </goals>

                <configuration>
                    <!-- General Configuration -->
                    <mirrorDirectory>${database.path}</mirrorDirectory>

                    <!-- Indexers -->
$gen{index-pom-complete-configuration}
                </configuration>
            </execution>
        </executions>
    </plugin>
</plugins>
```

</details>

## Indexing Workflow

The indexing process is responsible for transforming downloaded data into Lucene Indexes,
where each index consists of a set of documents structured as key-value pairs.
The specific data captured in these documents varies between indexes, based on the type of data they handle.

Indexers may depend on one or more downloads or other indexes.
If any required data or index is missing, the indexing process will not proceed.

Indexing is initiated under the following conditions:

- The index has not been created before.
- The index has failed in its last run.
- The index is older than a configured threshold.
- Any of the downloads or indexes it depends on have been updated since the last indexing.

<!--### Common Steps in the Indexing Process

While each indexer functions differently depending on the type of data it handles,
the following general steps are followed:

1. **Wait for Directory Unlock**: Before indexing, the directory must be unlocked to ensure other processes are not
   accessing or modifying the data.
2. **Lock Directory**: Once available, the directory is locked to prevent concurrent read/write operations.
3. **Check for Updates**: The system checks whether indexing is necessary based on the defined conditions. If no update
   is required, the process is aborted.
4. **Backup Existing Index**: A backup of the current index is made to prevent data loss in case of failure.
5. **Clear Current Index**: The existing index data is fully removed to prepare for the new data.
6. **Create Index**:
    - Validate that all required downloads and dependencies are available.
    - Generate the index documents, which differ by indexer.
    - Write the documents to the index directory if at least one document has been created.
7. **Handle Exceptions**: If an error occurs, the system reverts to the backup. Regardless of the outcome, the backup is
   removed after the process.
8. **Unlock Directory**: Once the indexing process is complete, the directory is unlocked to allow other processes
   access.-->

It cannot be stressed enough that since each indexer works with different data formats and sources,
they each require very specialized parsing methods.
These sources vary widely and may lack a consistent or machine-readable format, making the indexing process complex.
This is why a clear and defined preprocessing in form of a mapping of source fields to target fields in the Lucene index
is so important to the process.

# Indexers Details

$gen{index-full-doc}
