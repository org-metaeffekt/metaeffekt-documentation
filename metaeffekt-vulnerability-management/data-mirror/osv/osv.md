> [Documentation](../../../README.md) >
> [Vulnerability Management](../../vulnerability-management.md) >
> [Vulnerability Data Mirror](../vulnerability-data-mirror.md) >
> OSV

# Open Source Vulnerabilities (OSV)

> [Introduction](#introduction) -
> [Providers](#supported-providers) -
> [Ecosystems](#supported-ecosystems)

## Introduction

The [Open Source Vulnerabilities (OSV)](https://osv.dev) integration allows the inventory enrichment pipeline to match inventory artifacts against the distributed OSV database.
This process relies on Package URLs (PURL) on the inventory artifacts for matching the security advisories.
OSV entries are considered security advisories and may reference none or multiple vulnerabilities or other security advisories.

OSV is a project of Google which:

- Specifies "\[...] a standard interchange format for describing vulnerabilities in open source packages" by providing a [JSON Schema](https://ossf.github.io/osv-schema).
- Aggregates various databases using the OSV JSON Schema into their central database to distribute them more easily.

---

> [!TIP]
> Relevant documentation entries are:
>
> - [PURL handling in the enrichment process](../../inventory-enrichment/purl/purl.md)
> - [Tracking fixed software configurations](../fixed-software-versions.md)
> - [Introduction of OSV PURL matching in AE-1477](AE-1477.md)

## Supported Providers

OSV aggregates the OSV Databases of multiple OSV Advisory Providers.
A complete list can be found in their documentation: https://google.github.io/osv.dev/data

The OSV integration generally supports all providers, even as new ones are published.
The full list of known OSV Providers can be found in [content-identifiers.md](../../inventory-enrichment/template/content-identifiers.md#security-advisories-providers), filtering for the `implementation` value of `OSV`.

All providers can therefore be downloaded via the [OSV Downloader](../download.md#osv).
Certain providers like GitHub Security Advisories (GHSA) provide additional security advisories that can optionally be mirrored by including the [GHSA Downloader](../download.md#ghsa).
This relation can be seen in [the index data flow diagrams](../../diagrams/individual-index-diagrams.md#osv-advisor).

## Supported Ecosystems

The following table lists the PURL types currently supported by the enrichment process.
It lists the mapping between the internal PURL types and the official OSV ecosystem names used for querying the database.

| PURL Type / Namespace | Description          | OSV Ecosystem Name | PURL Examples                                               |
|:----------------------|:---------------------|:-------------------|:------------------------------------------------------------|
| **Linux Packages**    |                      |                    |                                                             |
| `alpm/archlinux`      | Arch Linux           |                    | `pkg:alpm/archlinux/pacman@6.0.2-11`                        |
| `apk/alpine`          | Alpine Linux         | `Alpine`           | `pkg:apk/alpine/curl@8.4.0-r0`                              |
| `deb/debian`          | Debian               | `Debian`           | `pkg:deb/debian/openssl@3.0.9-1`                            |
| `deb/ubuntu`          | Ubuntu               | `Ubuntu`           | `pkg:deb/ubuntu/dpkg@1.21.1ubuntu2.3`                       |
| `rpm/redhat`          | Red Hat              | `Red Hat`          | `pkg:rpm/redhat/kernel@4.18.0-372.9.1.el8`                  |
| `rpm/opensuse`        | SUSE / openSUSE      | `openSUSE`         | `pkg:rpm/opensuse/zypper@1.14.67-150500.3.15.1`             |
| `rpm/almalinux`       | AlmaLinux            | `AlmaLinux`        | `pkg:rpm/almalinux/openssl@3.0.7-24.el9`                    |
| `rpm/amazonlinux`     | Amazon Linux         |                    | `pkg:rpm/amazonlinux/openssl@3.0.8-1.amzn2023.0.3`          |
| `rpm/rockylinux`      | Rocky Linux          | `Rocky Linux`      | `pkg:rpm/rockylinux/vim-minimal@8.2.2637-16.el9_0`          |
| `rpm/mageia`          | Mageia               | `Mageia`           | `pkg:rpm/mageia/glibc@2.36-5.mga9`                          |
| **Languages**         |                      |                    |                                                             |
| `cargo`               | Rust                 | `crates.io`        | `pkg:cargo/rand@0.8.5`                                      |
| `composer`            | PHP                  | `Packagist`        | `pkg:composer/laravel/framework@10.25.1`                    |
| `cpan`                | Perl                 |                    | `pkg:cpan/OALDERS/libwww-perl@6.76`                         |
| `cran`                | R Project            | `CRAN`             | `pkg:cran/rJava@1.0-4`                                      |
| `gem`                 | Ruby                 | `RubyGems`         | `pkg:gem/rails@7.0.7`                                       |
| `golang`              | Go                   | `Go`               | `pkg:golang/google.golang.org/grpc@1.58.2`                  |
| `hackage`             | Haskell              | `Hackage`          | `pkg:hackage/AC-HalfInteger@1.2.1`                          |
| `hex`                 | Erlang / Elixir      | `Hex`              | `pkg:hex/phoenix@1.7.9`                                     |
| `maven`               | Java                 | `Maven`            | `pkg:maven/org.apache.logging.log4j/log4j-core@2.17.1`      |
| `npm`                 | JavaScript           | `npm`              | `pkg:npm/express@4.18.2`<br/>`pkg:npm/@angular/core@16.2.0` |
| `nuget`               | .NET                 | `NuGet`            | `pkg:nuget/Newtonsoft.Json@13.0.1`                          |
| `pypi`                | Python               | `PyPI`             | `pkg:pypi/django@4.2.5`                                     |
| `swift`               | Swift                | `SwiftURL`         | `pkg:swift/github.com/Alamofire/Alamofire@5.4.3`            |
| **Other**             |                      |                    |                                                             |
| `github`              | GitHub Repository    | `GIT`              | `pkg:github/package-url/purl-spec@a3b93a2`                  |
| `bitbucket`           | Bitbucket Repository | `GIT`              | `pkg:bitbucket/birkenfeld/pygments-main@244fd47e`           |
| `generic`             | Generic Package      |                    | `pkg:generic/openssl@3.0.12`                                |

## Matching OSV Entries

The matching logic is handled by the [`osvVulnerabilitiesEnrichment`](../../inventory-enrichment/inventory-enrichment-steps.md#osv-vulnerabilities) step.
Since PURLs are directly used for determining the applicability of a vulnerable software configuration on both sides of the comparison (artifacts, OSV), the excessive explicit configuration of PURL types (such as `maven` or `npm`) in previous versions is no longer required or possible, which simplifies configuration.

The process utilizes the [Effective PURLs](../../inventory-enrichment/purl/purl.md#effective-purls) calculated for each artifact.
These PURLs are compared against the software package information defined in the OSV advisories.
