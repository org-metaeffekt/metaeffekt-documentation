> [Documentation](../../README.md) >
> [Vulnerability Management](../vulnerability-management.md) >
> [Vulnerability Data Mirror](vulnerability-data-mirror.md) >
> Indexers

# Indexers

The indexers extract and process data from the downloads, organizing it into searchable formats for further use.
Each indexer processes data differently depending on the structure and type of data received from its associated
downloads.
A detailed overview of the dependencies between downloads and indexes is available on the individual index chapters
as seen below.

- [NVD CVE API](#nvd-cve-api)
- [NVD CPE API](#nvd-cpe-api)
- [NVD CPE API Vendor Product](#nvd-cpe-api-vendor-product)
- [MSRC Product](#msrc-product)
- [MSRC Advisor](#msrc-advisor)
- [MSRC KB Chain](#msrc-kb-chain)
- [GHSA Advisor](#ghsa-advisor)
- [CERT-SEI Advisor](#cert-sei-advisor)
- [CERT-FR Advisor](#cert-fr-advisor)
- [CERT-EU Advisor](#cert-eu-advisor)
- [KEV](#kev)
- [EPSS](#epss)
- [EOL](#eol)
- [_NVD Vulnerability (deprecated)_](#nvd-vulnerability-deprecated)
- [_CPE Dictionary (deprecated)_](#cpe-dictionary-deprecated)
- [_CPE Dictionary Vendor Product (deprecated)_](#cpe-dictionary-vendor-product-deprecated)

## Indexing Workflow

The indexing process is responsible for transforming downloaded data into Lucene Indexes,
where each index consists of a set of documents structured as key-value pairs.
The specific data captured in these documents varies between indexes, based on the type of data they handle.

Indexers may depend on one or more downloads or other indexes.
If any required data or index is missing, the indexing process will not proceed.

Indexing is initiated under the following conditions:

- The index has not been created before.
- The index has failed in its last run.
- The index is older than a configured threshold.
- Any of the downloads or indexes it depends on have been updated since the last indexing.

<!--### Common Steps in the Indexing Process

While each indexer functions differently depending on the type of data it handles,
the following general steps are followed:

1. **Wait for Directory Unlock**: Before indexing, the directory must be unlocked to ensure other processes are not
   accessing or modifying the data.
2. **Lock Directory**: Once available, the directory is locked to prevent concurrent read/write operations.
3. **Check for Updates**: The system checks whether indexing is necessary based on the defined conditions. If no update
   is required, the process is aborted.
4. **Backup Existing Index**: A backup of the current index is made to prevent data loss in case of failure.
5. **Clear Current Index**: The existing index data is fully removed to prepare for the new data.
6. **Create Index**:
    - Validate that all required downloads and dependencies are available.
    - Generate the index documents, which differ by indexer.
    - Write the documents to the index directory if at least one document has been created.
7. **Handle Exceptions**: If an error occurs, the system reverts to the backup. Regardless of the outcome, the backup is
   removed after the process.
8. **Unlock Directory**: Once the indexing process is complete, the directory is unlocked to allow other processes
   access.-->

It cannot be stressed enough that each indexer works with different data formats and sources,
often requiring specialized parsing methods.
These sources vary widely and may lack a consistent or machine-readable format, making the indexing process complex.
This is why a clear and defined preprocessing in form of a mapping of source fields to target fields in the Lucene index
is so important to the process.

# Indexers Details

## NVD CVE API

`nvd-cve` / `nvdVulnerabilityIndex`

| Dependency Type | Depends on |
| --- | --- |
| **Download** | [NVD CVE API](download.md#nvd-cve-api) |


## NVD CPE API

`cpe-dict` / `nvdCpeIndex`

| Dependency Type | Depends on |
| --- | --- |
| **Download** | [NVD CPE API](download.md#nvd-cpe-api) |


## NVD CPE API Vendor Product

`cpe-dict-vp` / `nvdCpeVendorProductIndex`

| Dependency Type | Depends on |
| --- | --- |
| **Index** | [NVD CPE API](#nvd-cpe-api) |


## MSRC Product

`msrc-products` / `msrcProductIndex`

| Dependency Type | Depends on |
| --- | --- |
| **Download** | [MSRC](download.md#msrc) |


## MSRC Advisor

`msrc-advisors` / `msrcAdvisorIndex`

| Dependency Type | Depends on |
| --- | --- |
| **Download** | [MSRC](download.md#msrc) |


## MSRC KB Chain

`msrc-kb-chains` / `msrcKbChainIndex`

| Dependency Type | Depends on |
| --- | --- |
| **Download** | [MSRC Security Guide](download.md#msrc-security-guide) |
| **Index** | [MSRC Advisor](#msrc-advisor), [MSRC Product](#msrc-product) |
| **Optional Download** | [MSRC Manual CSV](download.md#msrc-manual-csv) |


## GHSA Advisor

`github-advisory-database` / `githubAdvisorIndex`

| Dependency Type | Depends on |
| --- | --- |
| **Download** | [GHSA](download.md#ghsa) |


## CERT-SEI Advisor

`certsei-advisors` / `certSeiAdvisorIndex`

| Dependency Type | Depends on |
| --- | --- |
| **Download** | [CERT-SEI](download.md#cert-sei) |


## CERT-FR Advisor

`certfr-advisors` / `certFrAdvisorIndex`

| Dependency Type | Depends on |
| --- | --- |
| **Download** | [CERT-FR](download.md#cert-fr) |


## CERT-EU Advisor

`certeu-advisors` / `certEuAdvisorIndex`

| Dependency Type | Depends on |
| --- | --- |
| **Download** | [CERT-EU](download.md#cert-eu) |


## KEV

`kev` / `kevIndex`

| Dependency Type | Depends on |
| --- | --- |
| **Download** | [CISA KEV](download.md#cisa-kev) |


## EPSS

`epss` / `epssIndex`

| Dependency Type | Depends on |
| --- | --- |
| **Download** | [EPSS](download.md#epss) |


## EOL

`eol` / `eolIndex`

| Dependency Type | Depends on |
| --- | --- |
| **Download** | [EOL](download.md#eol) |


## _NVD Vulnerability (deprecated)_

`nvd-cve` / `nvdLegacyVulnerabilityIndex`

| Dependency Type | Depends on |
| --- | --- |
| **Download** | _NVD_ |


## _CPE Dictionary (deprecated)_

`cpe-dict` / `cpeDictionaryIndex`

| Dependency Type | Depends on |
| --- | --- |
| **Download** | _CPE Dictionary_ |


## _CPE Dictionary Vendor Product (deprecated)_

`cpe-dict-vp` / `cpeDictionaryVendorProductIndex`

| Dependency Type | Depends on |
| --- | --- |
| **Index** | _CPE Dictionary_ |

